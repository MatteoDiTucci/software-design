<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Generalise edge casesÔ∏è - Software Design</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A catalogue of what contributes to good software design">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/introduction.html"><strong aria-hidden="true">2.</strong> Passes all tests</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../passes-all-tests/test-pyramid.html"><strong aria-hidden="true">2.1.</strong> Test pyramid</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/if-testing-is-hard-inject.html"><strong aria-hidden="true">2.2.</strong> If testing is hard, inject what you need to verify</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/test-doubles.html"><strong aria-hidden="true">2.3.</strong> Test doubles</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/test-driven-development.html"><strong aria-hidden="true">2.4.</strong> Test driven development</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/test-coverage-is-not-enough.html"><strong aria-hidden="true">2.5.</strong> Test coverage is not enough</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/tests-must-be-reproducible.html"><strong aria-hidden="true">2.6.</strong> Tests must be reproducible</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/no-production-code-constants-in-tests.html"><strong aria-hidden="true">2.7.</strong> No production code constants in tests</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/do-not-test-libraries.html"><strong aria-hidden="true">2.8.</strong> Do not test libraries üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/component-tests-vs-end-to-end-tests-vs-monitoring-tradeoffs.html"><strong aria-hidden="true">2.9.</strong> Component tests vs end-to-end tests vs monitoring tradeoffs üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/expand-and-contract.html"><strong aria-hidden="true">2.10.</strong> Expand and contract üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/contract-testing.html"><strong aria-hidden="true">2.11.</strong> Contract testing üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/performance-tests.html"><strong aria-hidden="true">2.12.</strong> Performance tests üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/how-to-test-ui.html"><strong aria-hidden="true">2.13.</strong> How to test UI üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../passes-all-tests/linting.html"><strong aria-hidden="true">2.14.</strong> Linting üèóÔ∏è</a></li></ol></li><li class="chapter-item expanded "><a href="../expresses-intent/introduction.html"><strong aria-hidden="true">3.</strong> Expresses intent</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../expresses-intent/naming.html"><strong aria-hidden="true">3.1.</strong> Naming</a></li><li class="chapter-item expanded "><a href="../expresses-intent/deep-and-narrow-classes.html"><strong aria-hidden="true">3.2.</strong> Deep and narrow classes</a></li><li class="chapter-item expanded "><a href="../expresses-intent/immutability.html"><strong aria-hidden="true">3.3.</strong> Immutability</a></li><li class="chapter-item expanded "><a href="../expresses-intent/generalise-edge-cases.html" class="active"><strong aria-hidden="true">3.4.</strong> Generalise edge casesÔ∏è</a></li><li class="chapter-item expanded "><a href="../expresses-intent/small-classes-and-short-methods.html"><strong aria-hidden="true">3.5.</strong> Small classes and short methods üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../expresses-intent/liskov-substitution-principle.html"><strong aria-hidden="true">3.6.</strong> Liskov substitution principle üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../expresses-intent/usually-composition-is-better-than-inheritance.html"><strong aria-hidden="true">3.7.</strong> Usually composition is better than inheritance üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../expresses-intent/comment-the-why.html"><strong aria-hidden="true">3.8.</strong> Comment the why üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../expresses-intent/test-naming.html"><strong aria-hidden="true">3.9.</strong> Test naming üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../expresses-intent/visual-indentation.html"><strong aria-hidden="true">3.10.</strong> Visual indentation üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../expresses-intent/folder-structure.html"><strong aria-hidden="true">3.11.</strong> Folder structure üèóÔ∏è</a></li></ol></li><li class="chapter-item expanded "><a href="../does-not-repeat-itself/introduction.html"><strong aria-hidden="true">4.</strong> Does not repeat itself</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../does-not-repeat-itself/one-single-authoritative-representation.html"><strong aria-hidden="true">4.1.</strong> One single authoritative knowledge representation</a></li><li class="chapter-item expanded "><a href="../does-not-repeat-itself/do-not-abstract-by-visual-pattern-matching.html"><strong aria-hidden="true">4.2.</strong> Do not abstract by visual pattern matching</a></li><li class="chapter-item expanded "><a href="../does-not-repeat-itself/open-closed-principle.html"><strong aria-hidden="true">4.3.</strong> Open-closed principleÔ∏è</a></li><li class="chapter-item expanded "><a href="../does-not-repeat-itself/dependency-inversion-principle.html"><strong aria-hidden="true">4.4.</strong> Dependency inversion principle</a></li><li class="chapter-item expanded "><a href="../does-not-repeat-itself/information-hiding.html"><strong aria-hidden="true">4.5.</strong> Information hidingÔ∏è</a></li><li class="chapter-item expanded "><a href="../does-not-repeat-itself/polymorphism.html"><strong aria-hidden="true">4.6.</strong> Polymorphism üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../expresses-intent/single-responsibility-principle.html"><strong aria-hidden="true">4.7.</strong> Single responsibility principle üèóÔ∏è</a></li><li class="chapter-item expanded "><a href="../does-not-repeat-itself/interface-segregation-principle.html"><strong aria-hidden="true">4.8.</strong> Interface segregation principle üèóÔ∏è</a></li></ol></li><li class="chapter-item expanded "><a href="../does-not-contain-superfluous-parts/introduction.html"><strong aria-hidden="true">5.</strong> Does not contain superfluous parts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../does-not-contain-superfluous-parts/you-are-not-going-to-need-it.html"><strong aria-hidden="true">5.1.</strong> Does not contain superfluous parts</a></li><li class="chapter-item expanded "><a href="../does-not-contain-superfluous-parts/clarify-what-is-superfluous.html"><strong aria-hidden="true">5.2.</strong> Clarify what is superfluous</a></li><li class="chapter-item expanded "><a href="../does-not-contain-superfluous-parts/do-not-abuse-design-patterns.html"><strong aria-hidden="true">5.3.</strong> Do not abuse design patterns</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Software Design</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2><a class="header" href="#generalise-edge-cases" id="generalise-edge-cases">Generalise edge cases</a></h2>
<p>Generalising edge cases makes code easier to understand as we have a single implementation to reason on. Let's assume
we need to implement the following specifications for an airport check-in application:</p>
<ul>
<li>Verify a passenger passport has not expired</li>
<li>If the passenger is a minor from a national flight, verify in addition one of their parents passport</li>
<li>If the passenger is a minor from an international flight, verify in addition both parents passports</li>
</ul>
<pre><code class="language-kotlin">class CheckIn(private val today: LocalDate) {

  fun allowBoarding(passport: Passport): Boolean {
    return passport.isValid(today)
  }

  fun allowNationalFlightMinorBoarding(passport: Passport,
                                       parentPassport: Passport): Boolean {
    return passport.isValid(today) &amp;&amp; parentPassport.isValid(today)
  }

  fun allowInternationalFlightMinorBoarding(passport: Passport,
                                            firstParentPassport: Passport,
                                            secondParentPassport: Passport): Boolean {
    return passport.isValid(today)
        &amp;&amp; firstParentPassport.isValid(today)
        &amp;&amp; secondParentPassport.isValid(today)
  }
}

class Passport(private val name: String,
               private val lastName: String,
               private val expirationDate: LocalDate) {

  fun isValid(today: LocalDate): Boolean {
    return expirationDate.isBefore(today)
  }
}
</code></pre>
<p>The above <code>CheckIn</code> class can be simplified by collapsing the three methods into one that accepts a list of <code>Passport</code> 
like follows.</p>
<pre><code class="language-kotlin">class CheckIn(private val today: LocalDate) {

  fun allowBoarding(passports: List&lt;Passport&gt;): Boolean {
    if (passports.isEmpty()){
      return false
    }
      
    // In Kotlin, all() returns true only if all passports are valid
    return passports.all { passport -&gt; passport.isValid(today) }
  }
}

class Passport(private val name: String,
               private val lastName: String,
               private val expirationDate: LocalDate) {

  fun isValid(today: LocalDate): Boolean {
    return expirationDate.isBefore(today)
  }
}
</code></pre>
<p>The above version of <code>CheckIn</code> is easier to understand in terms of both internal implementation and the exposed methods. 
However, we could argue that the code is not expressing anymore the need to verify extra passports in case of minors. 
That information is still contained in the unit tests of the <code>CheckIn</code> class, some of which might be as follows.</p>
<pre><code class="language-kotlin">  @Test
  fun `blocks national flight boarding of a minor if their parent passport has expired`() {
    val checkIn = CheckIn(LocalDate.of(2021, 4, 4))
    val passport = Passport(&quot;Andrea&quot;, &quot;Diga Ford&quot;, LocalDate.of(2025, 1, 1))
    val parentPassport = Passport(&quot;Michael&quot;, &quot;Ford&quot;, LocalDate.of(2000, 1, 1))


    assertFalse(checkIn.allowBoarding(listOf(passport, parentPassport)))
  }

  @Test
  fun `blocks international flight boarding of a minor if one of their parent passport has expired`() {
    val checkIn = CheckIn(LocalDate.of(2021, 4, 4))
    val passport = Passport(&quot;Andrea&quot;, &quot;Diga&quot;, LocalDate.of(2025, 1, 1))
    val secondParentPassport = Passport(&quot;Mark&quot;, &quot;Diga&quot;, LocalDate.of(2035, 1, 1))
    val firstParentPassport = Passport(&quot;Michael&quot;, &quot;Ford&quot;, LocalDate.of(2000, 1, 1))

    assertFalse(checkIn.allowBoarding(listOf(
                                        passport,
                                        firstParentPassport,
                                        secondParentPassport)))
  }
</code></pre>
<br/>  
<h4><a class="header" href="#recommended-reads" id="recommended-reads">Recommended reads</a></h4>
<ul>
<li><a href="https://www.goodreads.com/book/show/31183020-99-bottles-of-oop">Following the Flocking Rules, chapter 3.6 of 99 bottles of OOP - Sandy Metz</a></li>
</ul>
<h4><a class="header" href="#teach-me-back" id="teach-me-back">Teach me back</a></h4>
<p>I really appreciate any <a href="(/introduction/introduction.html#teach-me-back)">feedback</a> about the book and my current understanding of software design.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../expresses-intent/immutability.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../expresses-intent/small-classes-and-short-methods.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../expresses-intent/immutability.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../expresses-intent/small-classes-and-short-methods.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>

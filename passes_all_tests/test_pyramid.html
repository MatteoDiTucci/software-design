<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Test pyramid - Software Design</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/introduction.html"><strong aria-hidden="true">2.</strong> Passes all tests</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../passes_all_tests/test_pyramid.html" class="active"><strong aria-hidden="true">2.1.</strong> Test pyramid</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/if_testing_is_hard_inject.html"><strong aria-hidden="true">2.2.</strong> If testing is hard, inject what you need to verify</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/test_doubles.html"><strong aria-hidden="true">2.3.</strong> Test doubles</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/test_driven_development.html"><strong aria-hidden="true">2.4.</strong> Test driven development</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/test_coverage_is_not_enough.html"><strong aria-hidden="true">2.5.</strong> Test coverage is not enough</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/tests_must_be_reproducible.html"><strong aria-hidden="true">2.6.</strong> Tests must be reproducible</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/do_not_test_libraries.html"><strong aria-hidden="true">2.7.</strong> Do not test libraries</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/component_tests_vs_end-to-end_tests_vs_monitoring_tradeoffs.html"><strong aria-hidden="true">2.8.</strong> Component tests vs end-to-end tests vs monitoring tradeoffs</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/contract_testing.html"><strong aria-hidden="true">2.9.</strong> Contract testing</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/do_not_use_production_constants.html"><strong aria-hidden="true">2.10.</strong> Do not use production constants</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/performance_tests.html"><strong aria-hidden="true">2.11.</strong> Performance tests</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/linting.html"><strong aria-hidden="true">2.12.</strong> Linting</a></li><li class="chapter-item expanded "><a href="../passes_all_tests/how_to_test_UI.html"><strong aria-hidden="true">2.13.</strong> How to test UI</a></li></ol></li><li class="chapter-item expanded "><a href="../expresses_intent/introduction.html"><strong aria-hidden="true">3.</strong> Expresses intent</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../expresses_intent/naming.html"><strong aria-hidden="true">3.1.</strong> Naming</a></li><li class="chapter-item expanded "><a href="../expresses_intent/deep_and_narrow_classes.html"><strong aria-hidden="true">3.2.</strong> Deep and narrow classes</a></li><li class="chapter-item expanded "><a href="../expresses_intent/small_classes_and_short_methods.html"><strong aria-hidden="true">3.3.</strong> Small classes and short methods</a></li><li class="chapter-item expanded "><a href="../expresses_intent/low_coupling_high_cohesion.html"><strong aria-hidden="true">3.4.</strong> Low coupling, high cohesion</a></li><li class="chapter-item expanded "><a href="../expresses_intent/encapsulation.html"><strong aria-hidden="true">3.5.</strong> Encapsulation</a></li><li class="chapter-item expanded "><a href="../expresses_intent/test_naming.html"><strong aria-hidden="true">3.6.</strong> Test naming</a></li></ol></li><li class="chapter-item expanded "><a href="../does_not_repeat_itself/introduction.html"><strong aria-hidden="true">4.</strong> Does not repeat itself</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../does_not_repeat_itself/one_single_authoritative_representation.html"><strong aria-hidden="true">4.1.</strong> One single authoritative knowledge representation</a></li><li class="chapter-item expanded "><a href="../does_not_repeat_itself/do_not_abstract_by_visual_pattern_matching.html"><strong aria-hidden="true">4.2.</strong> Do not abstract by visual pattern matching</a></li></ol></li><li class="chapter-item expanded "><a href="../does_not_contain_superfluous_parts/introduction.html"><strong aria-hidden="true">5.</strong> Does not contain superfluous parts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../does_not_contain_superfluous_parts/you_are_not_going_to_need_it.html"><strong aria-hidden="true">5.1.</strong> Does not contain superfluous parts</a></li><li class="chapter-item expanded "><a href="../does_not_contain_superfluous_parts/clarify_what_is_superfluous.html"><strong aria-hidden="true">5.2.</strong> Clarify what is superfluous</a></li><li class="chapter-item expanded "><a href="../does_not_contain_superfluous_parts/do_not_abuse_design_patterns.html"><strong aria-hidden="true">5.3.</strong> Do not abuse design patterns</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Software Design</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2><a class="header" href="#test-pyramid" id="test-pyramid">Test pyramid</a></h2>
<p>There are different kinds of tests, each one meant for a different purpose. Before describing the most common ones, let's
clarify in advance a couple of terms. For <em>service</em> we mean a bunch of code deployed as a whole. For
<em>external dependencies</em> we mean anything that is reached over the network, like a database, another team REST endpoint, a queue, third party apis, etc.</p>
<ul>
<li><strong>Acceptance tests</strong><br />
Check that a feature behaves as expected across all service layers (e.g. back end and front end) or even
across different services. External dependencies are replaced through libraries like <a href="https://github.com/localstack/localstack">LocalStack</a>
or <a href="http://wiremock.org/">Wiremock</a>. In a web application for instance, acceptance tests are defined with tools like <a href="https://www.selenium.dev/">Selenium</a>
or <a href="https://www.cypress.io/">Cypress</a>.</li>
<li><strong>Functional tests</strong><br />
Check that a feature behaves as expected considering a single layer of a service. For example, if a service have both back end and
front end, there will be distinct functional tests for the back end and front end. External dependencies are replaced either
by libraries like <a href="https://github.com/localstack/localstack">LocalStack</a> or by <a href="#test-doubles">doubles</a>.
Functional tests are also called component tests.</li>
<li><strong>Integration tests</strong><br />
Check that a service integrates correctly with external dependencies. External dependencies are replaced by libraries like
<a href="https://github.com/localstack/localstack">LocalStack</a> or <a href="http://wiremock.org/">Wiremock</a>. If you use code <a href="#test-doubles">doubles</a>
for the external dependencies then it is a unit test.</li>
<li><strong>Unit tests</strong><br />
Check that code inside one class behaves as expected. Unit tests are most valuable when testing business logic: if a class is just a
<a href="https://en.wikipedia.org/wiki/Delegation_pattern">delegator</a> or just coordinates other classes, do not use unit tests
as functional tests already provide coverage. If the class under test uses other classes whose construction is cumbersome,
those can be replaced with   <a href="#test-doubles">doubles</a></li>
</ul>
<p>The above list is ordered by how much time a test takes to execute, from the slowest (acceptance) to the fastest (unit).
For this reason, it is recommended to have a pyramid of tests: a handful of acceptance tests, some functional and integration
tests and many unit tests. In particular:</p>
<ul>
<li><strong>Acceptance tests</strong><br />
Only for default uses of a feature</li>
<li><strong>Functional tests</strong><br />
For both default and exceptional-erroneous uses of a feature</li>
<li><strong>Integration tests</strong><br />
For both default and exceptional-erroneous integrations with external dependencies</li>
<li><strong>Unit tests</strong><br />
For both default and exceptional-erroneous usage of a single class</li>
</ul>
<p>[1] <a href="https://martinfowler.com/bliki/TestPyramid.html">Test Pyramid (in short) - Martin Fowler</a><br />
[2] <a href="https://martinfowler.com/articles/practical-test-pyramid.html">Test Pyramid (in depth) - Ham Vocke</a><br />
[3] <a href="https://www.goodreads.com/book/show/4268826-growing-object-oriented-software-guided-by-tests">Growing Object-Oriented Software, Guided by Tests - Steve Freeman, Nat Pryce</a>
[4] <a href="https://testing.googleblog.com/2020/11/fixing-test-hourglass.html">Fixing a Test Hourglass, Google testing blog - Alan Myrvold</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../passes_all_tests/introduction.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../passes_all_tests/if_testing_is_hard_inject.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../passes_all_tests/introduction.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../passes_all_tests/if_testing_is_hard_inject.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
